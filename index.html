<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ERA IoT Dashboard</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
  <h2>ðŸ“¡ Dá»¯ liá»‡u tá»« ESP32 qua ERA IoT</h2>
  <p>Nhiá»‡t Ä‘á»™: <span id="temp">--</span> Â°C</p>
  <p>Nhá»‹p tim: <span id="heart">--</span> bpm</p>
  <p>SpO2: <span id="spo2">--</span> %</p>
  <p>Huyáº¿t Ã¡p: <span id="bp">--</span> mmHg</p>

  <script>
    // Káº¿t ná»‘i MQTT tá»›i ERA
    const client = mqtt.connect("wss://mqtt.era.vn:8084/mqtt", {
      username: "15794",      // ID thiáº¿t bá»‹
      password: "1ced9c99-1cd3-45f6-98a1-82ea28141f85"   // Secret thiáº¿t bá»‹
    });

    client.on("connect", () => {
      console.log("âœ… Connected to ERA MQTT");
      // Subscribe cÃ¡c topic dá»¯ liá»‡u
      client.subscribe("eoh/chip/15794/config/132974/value"); // VÃ­ dá»¥ cho V0
    });

    client.on("message", (topic, message) => {
      const data = JSON.parse(message.toString());
      console.log("ðŸ“¥", topic, data);

      // Giáº£ sá»­ V0 = Nhiá»‡t Ä‘á»™
      if (topic.includes("132974")) {
        document.getElementById("temp").innerText = data.v.toFixed(2);
      }
      // TÆ°Æ¡ng tá»±: thÃªm cho V1, V2, V3
    });
  </script>
</body>
</html>
